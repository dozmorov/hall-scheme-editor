<!--
  ~ Copyright (c) 2019 ООО «МДТЗК» (ticketland.ru)
  ~ Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense copies of the Software,  and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
  ~
  ~ The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
  ~
  ~ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  -->

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Инструкция для редактора схем залов</title>
	<link rel="stylesheet" href="css/style.css">
	<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
</head>
<body>

	<a name="top"></a>

	<div>&nbsp;</div>

	<div class="container">
		<div class="sitebody">

			<h5>Март 2019</h5>

			<h1>Инструкция для редактора схем залов</h1>

			<!-- Оглавление -->

			<h3>Оглавление</h3>

			<ul>
				<li><a href="#interface">Интерфейс</a></li>
				<li><a href="#library">Библиотека элементов</a></li>
				<li><a href="#properties">Свойства мест и объектов</a></li>
				<li><a href="#tools">Инструменты</a></li>
				<li><a href="#navigation">Управление рабочей областью</a></li>
				<li><a href="#layers">Порядок слоев</a></li>
				<li><a href="#keyboard_shortcuts">Быстрые клавиши</a></li>
				<li><a href="#places">Работа с местами</a></li>
				<li><a href="#objects">Работа с объектами</a></li>
				<li><a href="#sections">Добавление секторов</a></li>
				<li><a href="#saving">Сохранение, просмотр и публикация</a></li>
				<li><a href="#known_errors">Известные ошибки</a></li>
				<li><a href="#useful">Хозяйке на заметку</a></li>
			</ul>

			<!-- Интерфейс -->

			<a name="interface"></a>

			<h3>Интерфейс</h3>

			<p>Слева в интерфейсе находится <strong>библиотека элементов</strong>, в центре - <strong>рабочая область</strong>, справа - <strong>панель свойств</strong>.</p>

			<p>Слева вверху рабочей области закреплена <strong>панель инструментов</strong>, справа - <strong>инструменты навигации</strong>.</p>

			<hr>

			<img src="assets/img/interface.jpg" alt="Интерфейс редактора" />

			<hr>

			<!-- Библиотека объектов -->

			<a name="library"></a>

			<h3>Библиотека элементов</h3>

			<p>Слева в редакторе находится библиотека элементов, выбрав нужный элемент, можно разместить его в рабочей области.</p>

			<p><strong>Сцена</strong> - прямоугольный объект с произвольной шириной и высотой, который нужно разместить в той части рабочей области, где находится сцена в настоящем зале.</p>

			<p><strong>Арена</strong> - "круглая сцена", круг с произвольным радиусом, который нужно разместить в той части рабочей области, где находится арена в настоящем зале. Подходит для цирков.</p>

			<p><strong>Прямая лестница</strong> – сегмент лестницы, которым можно обозначить лестницу, расположенную в зале. Для того, чтобы нарисовать длинную лестницу, можно совместить несколько сегментов.</p>

			<p><strong>Лестница 45</strong> – сегмент полукруглой лестницы, поворачивающей на 45˚, несколькими сегментами можно нарисовать лестницу, поворачивающую на 90, 135, 270 и 315 градусов, либо лестницу, которая меняет направление. Можно совмещать прямые и поворачивающие сегменты.</p>

			<p><blockquote>Увеличивать или уменьшать лестницы, колонны и выходы можно только с сохранением исходных пропорций (соотношения сторон).</blockquote></p>

			<p><strong>Прямоугольная колонна</strong>,<strong>Круглая колонна</strong> нужно размещать в зале в месте расположения колонн (если они есть).</p>

			<p><blockquote>Колонна, расположенная между местом и сценой мешает обзору, такие места продаются хуже.</blockquote></p>

			<p><strong>Выходы</strong> символизируют выходы в зрительном зале.</p>

			<p><strong>Выход артистов</strong> – объект для цирковой арены.</p>

			<p><blockquote>Места, расположенные в цирке напротив выхода артистов продаются лучше, в какой-то степени "выход артистов" символизирует сцену в театре.</blockquote></p>

			<p class="str"><strong>Стена</strong></p>

			<p><strong>Стол прямоугольный</strong>, <strong>стол круглый</strong>, <strong>стол овальный</strong>, <strong>диван прямой</strong> и <strong>диван угловой</strong> символизируют столы/диваны на площадках, где продаются места за столиками или на диванах.</p>

			<!-- Свойства мест и объектов -->

			<a name="properties"></a>

			<h3>Свойства мест и объектов</h3>

			<p>Если выбрать мышкой место или объект, который находится в зале, в правой панели редактора появятся свойства, которые доступны для этого объекта или места. Некоторые свойства можно редактировать в полях этой панели.</p>

			<hr>

			<img src="assets/img/properties.gif" alt="Свойства объектов" />

			<hr>

			<p>Если выделено несколько объектов, будут показаны свойства для всей группы.</p>

			<h4>Свойства мест</h4>

			<p><strong>Секция</strong> – [IdSection] и название секции (если есть) из базиса.</p>

			<p><strong>Ряд</strong>, <strong>место</strong> - номер ряда и номер места.</p>

			<h4>Свойства мест и объектов</h4>

			<p><strong>Скрытый</strong> – это свойство позволяет скрывать места или объекты с сайта. В редакторе такие объекты будут полупрозрачными.</p>

			<p><strong>Координата X</strong> [px] - координата центра объекта (или группы) по горизонтальной оси на рабочей области, аналогично координате по 'x' в математике (-∞,+∞).</p>

			<p><strong>Координата Y</strong> [px] - координата центра объекта (или группы) по вертикальной оси на рабочей области, инвертированная координата по 'y' в математике (-∞,+∞). То есть, на рабочей области координата Y растет при движении по оси сверху вниз.</p>

			<p class="str"><strong>Координата Z</strong> [px]</p>

			<p><strong>Ширина и высота</strong> [px] – ширина и высота объекта или группы выделенных объектов в пикселях.</p>

			<!-- Инструменты -->

			<a name="tools"></a>

			<h3>Инструменты</h3>

			<p>В панели инструментов (закреплена в верхнем левом углу рабочей области) можно выбрать нужный инструмент.</p>

			<p><strong>Выделение</strong> (курсор) – позволяет выделить один или несколько элементов, масштабировать или поворачивать выделенные объекты.</p>

			<p class="str"><strong>Прямоугольник</strong></p>

			<p class="str"><strong>Круг</strong></p>

			<p><strong>Текст</strong> – позволяет добавить на рабочую область текст.</p>

			<p class="str"><strong>Фигура</strong></p>

			<p class="str"><strong>Поворот</strong></p>

			<!-- Управление рабочей областью -->

			<a name="navigation"></a>

			<h3>Управление рабочей областью</h3>

			<p>Справа вверху рабочей области закреплены элементы управления.</p>

			<p><strong>Зум</strong> (+ и -) – приближает или отдаляет зал.</p>

			<p><blockquote>Колесико мыши так же приближает либо отдаляет схему зала.</blockquote></p>

			<p><strong>Отмена <span class="str">и повтор</span> последнего действия</strong> – позволяет отменить последние действия (хранит последние 10 действий).</p>

			<p><blockquote>Действие нельзя отменить, если после него была нажата кнопка "Save".</blockquote></p>

			<p><blockquote>Быстрая клавиша для отмены – Ctrl/Cmd + Z.</blockquote></p>

			<p>Для того, чтобы подвинуть рабочую область, нужно зажать клавишу alt и подвинуть область мышью.</p>

			<!-- Порядок слоев -->

			<a name="layers"></a>

			<h3>Порядок слоев</h3>

			<p>Разные типы объектов имеют разный приоритет наложения друг на друга:</p>

			<ol>
				<li>Места всегда будут расположены выше других объектов</li>
				<li>Ниже мест расположены все остальные объекты из библиотеки</li>
				<li>Секторы всегда расположены ниже любых других объектов</li>
			</ol>

			<p><blockquote>Если несколько объектов одного типа, например, стол и лестница пересекутся друг с другом, выше окажется тот объект, который добавлен на рабочую область позже.</blockquote></p>

			<!-- Быстрые клавиши -->

			<a name="keyboard_shortcuts"></a>

			<h3>Быстрые клавиши</h3>

			<p><blockquote>Для macOS функцию Ctrl выполняет ⌘ Cmd, Alt - клавиша ⎇ Option.</blockquote></p>

			<ol>

				<li>

					<strong>Ctrl + Z</strong> - отмена предыдущего действия. Редактор хранит последние 10 действий с момента последнего сохранения, которые можно отменять.

					<blockquote>Редактор не сможет отменить действия, которые были сделаны раньше, чем последнее сохранение схемы. В некоторых случаях отмена последнего действия может занять значительное время.</blockquote>

				</li>

				<li><strong>Escape (esc)</strong> – переводит редактор в режим "выделение", какой бы инструмент не был выбран до этого.</li>

				<li><strong>Стрелки (←, →, ↑, ↓)</strong> - подвинут выбранный объект на 1 px в соответствующую сторону, минуя стандартную сетку редактора.</li>

				<li><strong>Shift + стрелки (←, →, ↑, ↓)</strong> - подвинут выбранный объект на 8 px в соответствующую сторону.</li>

				<li><strong>Delete</strong>, либо <strong>backspace (⇐)</strong> – удалит выделенный объект с рабочей области.</li>

				<li><strong>Зажав клавишу alt</strong>, можно двигать рабочую область курсором мыши.</li>

			</ol>

			<!-- Работа с местами -->

			<a name="places"></a>

			<h3>Работа с местами</h3>

			<p>Места можно перемещать мышью или вводя координаты в панели свойств. В общем случае, лучше располагать места на расстоянии 24 px между их центрами. К рабочей области применяется сетка с шагом 4 px.</p>

			<p><blockquote>Места из базиса загружаются с расстоянием 50 px между ними.</blockquote></p>

			<hr>

			<img src="assets/img/places.gif" alt="Работа с местами">

			<hr>

			<p>Координаты X и Y можно изменять прямо в панели свойств. Если ввести значение X или Y для группы объектов, то это значение обновится для каждого объекта, а не для группы. Например, если выделить два объекта и внести координату по X, не группа, а каждый из объектов переместится в точку с координатой X (при этом Y останется таким, каким был). Аналогично для координаты по оси Y.</p>

			<p><blockquote>Если при обновлении координат любое из мест наложится на любое другое место, координаты обновлены не будут, и место (или выделенная группа) останется там, где было до этого.</blockquote></p>

			<p><blockquote>Не смотря на то, что при импорте схемы из базиса, места могут получить дробные координаты, координаты, введенные в панели свойств или полученные после перемещения округляются до ближайшего пикселя. </blockquote></p>

			<p>Нельзя добавлять или удалять места.</p>

			<p>Если нужно скрыть места, можно применить к ним галочку "скрытый". Места будут показаны в редакторе полупрозрачными, на сайт эти места не выгрузятся.</p>

			<p>Чтобы отобразить скрытые места на сайте, нужно снять для них галочку.</p>

			<p><blockquote>Скрывать и отображать места и объекты можно группой, для этого нужно выделить несколько объектов и поставить галочку "скрытый".</blockquote></p>

			<!-- Работа с объектами -->

			<a name="objects"></a>

			<h3>Работа с объектами</h3>

			<p>Слева в редакторе находится библиотека элементов, выбрав нужный элемент, можно разместить его в рабочей области.</p>

			<p>В отличие от мест, объекты можно удалять, копировать, масштабировать и поворачивать.</p>

			<hr>

			<img src="assets/img/objects.gif" alt="Работа с объектами">

			<hr>

			<p>Чтобы удалить объект с рабочей области, нужно выбрать его и нажать клавишу 'delete' или 'backspace' (любую).</p>

			<p>Увеличить или уменьшить объект можно потянув мышью за любой из четырех углов выделения. Объект "сцена" можно увеличивать непропорционально, например, только по высоте или по ширине, для этого нужно потянуть мышью за одно из ребер выделения.</p>

			<p>Чтобы повернуть объект, нужно выделить его и потянуть его за отдельно стоящий квадратик выделения.</p>

			<p><blockquote>Для поворота, как и для перемещения, действует сетка: нельзя повернуть объект на произвольный угол, только на угол, кратный 15˚.</blockquote></p>

			<p>Объекты можно расставлять по рабочей области вводя координаты в панели свойств, аналогично местам.</p>

			<!-- Добавление секторов -->

			<a name="sections"></a>

			<h3>Добавление секторов</h3>

			<p>Сектор добавляется на рабочую область по точкам. Для того, чтобы начать строить сектор, нужно справа в панели свойств зала нажать кнопку "добавить сектор". Клик в рабочей области поставит в этом месте первую точку, второй клик - вторую и т.д.</p>

			<hr>

			<img src="assets/img/sections.gif" alt="Добавление секторов">

			<hr>

			<p><strong>Чтобы выйти из режима построения сектора, нажмите клавишу escape, либо выберите инструмент "выделение" в панели инструментов.</strong></p>

			<p>Точки можно выделять по-отдельности, перетаскивать, назначать им координаты или удалять их.
			Выделенный целиком сектор можно масштабировать.</p>

			<p>В панели свойств сектора можно назначать им имена и менять их цвет.</p>

			<hr>

			<img src="assets/img/sections_color.gif" alt="Цвет секторов">

			<hr>

			<!-- Соханение, просмотр и публикация -->

			<a name="saving"></a>

			<h3>Сохранение, просмотр и публикация</h3>

			<p>Кнопка 'save' внизу панели свойств сохранит все изменения в зале под тем же 'internal id'. Чтобы загрузить зал снова, нужно ввести его 'internal id' в поле с подсказкой 'Enter internal id' и нажать кнопку 'Load'. Зал будет загружен со всеми сохраненными изменениями.</p>

			<p><blockquote>Загружать зал после каждого сохранения не нужно, после нажатия кнопки 'save' можно продолжать работу.</blockquote></p>

			<p>Если вы хотите предварительно посмотреть как будет выглядеть схема после публикации ее на сайте, можно нажать кнопку 'preview': редактор откроет в новой вкладке файл, который был бы выгружен на сайт при публикации.</p>

			<p><blockquote>Предпросмотром схемы можно пользоваться в любой момент, редактор сгенерирует временный файл, схема не будет ни сохранена, ни опубликована.</blockquote></p>

			<!-- Известные ошибки -->

			<a name="known_errors"></a>

			<h3>Известные ошибки</h3>

			<p>К ошибкам добавлены варианты обходного решения.</p>

			<p>

				<ol>

					<li>

						Нельзя разместить на рабочей области объекты: стена, стол круглый, стол овальный.

					</li>

					<li>

						Объект "центр сцены" сбрасывается, если вся сцена была перемещена

					</li>

					<li>

						Зона выделения некоторых объектов не совпадает с размерами самих объектов

					</li>

				</ol>

			</p>

			<!-- Хозяйке на заметку -->

			<a name="useful"></a>

			<h3>Хозяйке на заметку</h3>

			<h4>Формула для расчета координат мест, расположенных по дуге</h4>

			<p>
				$$
					x = r \cdot \cos { \pi / n }
				$$

				$$
					y = \pm \sqrt { r^2 - \left( r \cdot \cos { \pi / n } \right)^2 }
				$$
			</p>

			<p>

				Где:

				<ul>

					<li>угол расчитывается в радианах (2π = 360˚)</li>

					<li><em><strong>x, y</strong></em> – координаты X, Y</li>

					<li><en><strong>r</strong></en> – радиус окружности, на которой располагается дуга</li>

					<li><em><strong>n</strong></em> – количество мест, которые должны поместиться на дуге 180˚ (без учета промежутков)</li>

				</ul>

			</p>

			<p>
				<hr>
			</p>

			<a class="btn" href="#top" target="_self">Наверх</a>

			<div>&ensp;</div>

			<div>&ensp;</div>


		</div>
	</div>

	<div>&ensp;</div>

</body>
</html>
